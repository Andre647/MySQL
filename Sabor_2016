/* SABORES MAIS VENDIDOS EM 2016 */
SELECT TP.SABOR,SUM(INF.QUANTIDADE)AS TOTAL,YEAR(NF.DATA_VENDA) AS ANO
FROM tabela_de_produtos TP
INNER JOIN itens_notas_fiscais INF
ON TP.CODIGO_DO_PRODUTO = INF.CODIGO_DO_PRODUTO
INNER JOIN notas_fiscais NF
ON NF.NUMERO = INF.NUMERO
WHERE  YEAR(NF.DATA_VENDA)= 2016
GROUP BY TP.SABOR,YEAR(NF.DATA_VENDA)
ORDER BY SUM(INF.QUANTIDADE) DESC;
